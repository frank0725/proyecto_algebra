<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Proyecto algebra</title>
<style>
body { font-family:'Segoe UI',sans-serif; background:#f4f6f8; margin:0; padding:0; color:#333;}
header{background:#003366;color:white;text-align:center;padding:20px;font-size:2em;box-shadow:0 2px 5px rgba(0,0,0,0.2);}
main{max-width:900px;margin:30px auto;background:white;padding:25px;border-radius:8px;box-shadow:0 3px 10px rgba(0,0,0,0.1);}
.controls{text-align:center;margin-bottom:15px;}
button{border:none;padding:10px 15px;margin:5px;border-radius:4px;cursor:pointer;transition:transform 0.2s,background 0.3s;color:white;font-weight:bold;}
button:hover{transform:scale(1.05);}
.sum-btn{background:#0074D9;} .sum-btn:hover{background:#005fa3;}
.sub-btn{background:#FF4136;} .sub-btn:hover{background:#cc332b;}
.mul-btn{background:#2ECC40;} .mul-btn:hover{background:#24a534;}
.det-btn{background:#FFDC00;color:#333;} .det-btn:hover{background:#e6c200;}
h2,h3{text-align:center;color:#003366;}
.matrix-input{margin-bottom:20px;padding:10px;border-radius:6px;}
.matrix-A{background:#e6f2ff;}
.matrix-B{background:#e6ffe6;}
.matrix-result{background:#fff5e6;}
.matrix-input input{width:60px;padding:5px;margin:3px;text-align:center;border:1px solid #ccc;border-radius:4px;}
.result{text-align:center;margin-top:20px;}
table{margin:0 auto;border-collapse:collapse;}
td{border:1px solid #ccc;padding:8px 12px;min-width:40px;text-align:center;font-weight:bold;opacity:0;transform:translateY(-20px);}
td.show{opacity:1;transform:translateY(0);transition:all 0.5s cubic-bezier(0.68,-0.55,0.27,1.55);}
td.highlight{background-color:#ffeb3b;transition:background-color 0.5s;}
.message{text-align:center;font-style:italic;color:#555;margin-bottom:20px;}
#toast{visibility:hidden;min-width:200px;margin-left:-100px;background:#333;color:#fff;text-align:center;border-radius:6px;padding:10px;position:fixed;z-index:100;left:50%;bottom:30px;font-size:14px;}
#toast.show{visibility:visible;animation:fadein 0.5s,fadeout 0.5s 2.5s;}
@keyframes fadein{from{bottom:0;opacity:0;}to{bottom:30px;opacity:1;}}
@keyframes fadeout{from{bottom:30px;opacity:1;}to{bottom:0;opacity:0;}}
#reminder{position:fixed;top:80px;right:20px;width:250px;padding:15px;background:#003366;color:white;border-radius:8px;box-shadow:0 3px 8px rgba(0,0,0,0.3);opacity:0;transform:translateX(100px);font-size:14px;}
#reminder.show{opacity:1;transform:translateX(0);transition:all 0.7s ease-out;}
#reminder p{margin:8px 0;}
select{margin-left:10px;padding:3px;border-radius:4px;}
</style>
</head>
<body>

<header>Bienvenido al proyecto de Álgebra lineal</header>
<main>

<div class="controls">
    <button class="sum-btn" onclick="calculate('sum')">Sumar</button>
    <button class="sub-btn" onclick="calculate('subtract')">Restar</button>
    <button class="mul-btn" onclick="calculate('multiply')">Multiplicar</button>
    <button class="det-btn" onclick="calculate('determinant')">Determinante A</button>
</div>

<div class="controls">
  <h3>Matriz A</h3>
  Filas: <input type="number" id="rowsA" min="1" value="2">
  Columnas: <input type="number" id="colsA" min="1" value="2">
  <br>
  <h3>Matriz B</h3>
  Filas: <input type="number" id="rowsB" min="1" value="2">
  Columnas: <input type="number" id="colsB" min="1" value="2">
  <br>
  <button onclick="generateMatrices()">Generar Matrices</button>
  <button onclick="resetMatrices()">Resetear</button>
  <button onclick="showCurrentMatrices()">Mostrar Matrices</button>
</div>

<div id="matrices"></div>

<div class="controls">
    <label for="resultOption">Transformar resultado:</label>
    <select id="resultOption" onchange="applyResultOption()">
        <option value="normal">Normal</option>
        <option value="transpose">Transpuesta</option>
        <option value="inverse">Inversa</option>
        <option value="determinant">Determinante</option>
    </select>
</div>

<div class="result" id="result"></div>
<div id="toast"></div>
<div id="reminder"><h4>Recordatorio de Álgebra</h4><div id="reminder-content"></div></div>

<script>
// Variables globales
let currentA = [];
let currentB = [];
let lastResult = [];

// TOAST Y RECORDATORIOS
function showToast(msg) {
    const toast = document.getElementById('toast'); 
    toast.textContent = msg; 
    toast.className = 'show'; 
    setTimeout(() => { toast.className = ''; }, 3000);
}

function showReminder(content) {
    const reminder = document.getElementById('reminder');
    document.getElementById('reminder-content').innerHTML = content; 
    reminder.classList.add('show'); 
    setTimeout(() => { reminder.classList.remove('show'); }, 8000);
}

// GENERAR MATRICES
function generateMatrices() {
    const rowsA = parseInt(document.getElementById('rowsA').value);
    const colsA = parseInt(document.getElementById('colsA').value);
    const rowsB = parseInt(document.getElementById('rowsB').value);
    const colsB = parseInt(document.getElementById('colsB').value);
    
    let html = '<h3>Matriz A</h3><div class="matrix-input matrix-A">';
    for(let i = 0; i < rowsA; i++) {
        for(let j = 0; j < colsA; j++) { html += `<input type="number" id="a-${i}-${j}" value="0">`; }
        html += '<br>';
    }
    html += '</div><h3>Matriz B</h3><div class="matrix-input matrix-B">';
    for(let i = 0; i < rowsB; i++) {
        for(let j = 0; j < colsB; j++) { html += `<input type="number" id="b-${i}-${j}" value="0">`; }
        html += '<br>';
    }
    html += '</div>'; 
    
    document.getElementById('matrices').innerHTML = html; 
    document.getElementById('result').innerHTML = '';
    
    currentA = readMatrix('A');
    currentB = readMatrix('B');
    
    showToast("Ingresa los valores en las matrices");
}

function showCurrentMatrices() {
    console.log("Matriz A actual:", currentA);
    console.log("Matriz B actual:", currentB);
    showToast("Matrices actuales mostradas en consola");
}

function resetMatrices() {
    document.getElementById('rowsA').value = 2;
    document.getElementById('colsA').value = 2;
    document.getElementById('rowsB').value = 2;
    document.getElementById('colsB').value = 2;
    document.getElementById('resultOption').value = 'normal';
    generateMatrices();
}

// FUNCIONES MATEMÁTICAS
function transposeMatrix(M) {
    let rows = M.length, cols = M[0].length, T = [];
    for(let i=0;i<cols;i++){ T[i] = []; for(let j=0;j<rows;j++){ T[i][j]=M[j][i]; } }
    return T;
}

function determinant(M) {
    if(M.length===1) return M[0][0]; 
    if(M.length===2) return M[0][0]*M[1][1]-M[0][1]*M[1][0];
    let det=0;
    for(let i=0;i<M[0].length;i++){
        let sub=M.slice(1).map(r=>r.filter((_,j)=>j!==i));
        det+=((i%2===0?1:-1)*M[0][i]*determinant(sub));
    }
    return det;
}

function inverseMatrix(M) {
    if(M.length!==M[0].length){ showToast("Matriz no cuadrada"); return null; }
    let det = determinant(M); if(det===0){ showToast("Matriz no invertible"); return null; }
    let n = M.length;
    let I = Array.from({length:n},(_,i)=>Array.from({length:n},(_,j)=>i===j?1:0));
    let A = M.map(r=>r.slice());
    for(let i=0;i<n;i++){
        if(A[i][i]===0){
            let found=false;
            for(let j=i+1;j<n;j++){
                if(A[j][i]!==0){ [A[i],A[j]]=[A[j],A[i]]; [I[i],I[j]]=[I[j],I[i]]; found=true; break; }
            }
            if(!found) return null;
        }
        let f=A[i][i];
        for(let j=0;j<n;j++){ A[i][j]/=f; I[i][j]/=f; }
        for(let k=0;k<n;k++){
            if(k!==i){ let factor=A[k][i]; for(let j=0;j<n;j++){ A[k][j]-=factor*A[i][j]; I[k][j]-=factor*I[i][j]; } }
        }
    }
    return I;
}

function multiplyMatrices(A,B){
    let rA=A.length,cA=A[0].length,rB=B.length,cB=B[0].length;
    let R=Array.from({length:rA},()=>Array(cB).fill(0));
    for(let i=0;i<rA;i++){ for(let j=0;j<cB;j++){ for(let k=0;k<cA;k++){ R[i][j]+=A[i][k]*B[k][j]; } } }
    return R;
}

function readMatrix(matrix){
    const rows=parseInt(document.getElementById('rows'+matrix).value);
    const cols=parseInt(document.getElementById('cols'+matrix).value);
    let M=[];
    for(let i=0;i<rows;i++){
        M[i]=[];
        for(let j=0;j<cols;j++){
            let val=document.getElementById(`${matrix.toLowerCase()}-${i}-${j}`);
            M[i][j]=val && !isNaN(val.value)?parseFloat(val.value):0;
        }
    }
    return M;
}

// CÁLCULOS
function calculate(op){
    currentA = readMatrix('A');
    currentB = readMatrix('B');
    let result=[];
    try{
        if(op==='sum'||op==='subtract'){
            if(currentA.length!==currentB.length||currentA[0].length!==currentB[0].length){
                showToast("Dimensiones inválidas"); showReminder("<p>Para sumar/restar: matrices deben ser del mismo tamaño</p>"); return;
            }
            result=currentA.map((row,i)=>row.map((val,j)=>op==='sum'?val+currentB[i][j]:val-currentB[i][j]));
        } else if(op==='multiply'){
            if(currentA[0].length!==currentB.length){ showToast("Columnas A ≠ filas B"); showReminder("<p>Multiplicación: columnas A = filas B</p>"); return; }
            result=multiplyMatrices(currentA,currentB);
        } else if(op==='determinant'){
            if(currentA.length!==currentA[0].length){ showToast("Solo matrices cuadradas"); showReminder("<p>Determinante solo para matrices cuadradas</p>"); return; }
            let det=determinant(currentA);
            showToast("Determinante: "+det); showReminder("<p>Determinante calculado correctamente</p>");
            lastResult=[[det]]; displayResult([[det]],"Determinante de A"); return;
        }
        lastResult=result; displayResult(result,"Resultado de las dos matrices"); showToast("Operación realizada con éxito");
    }catch(error){ showToast("Error: "+error.message); console.error(error); }
}

// MOSTRAR RESULTADO
function displayResult(matrix,label="Resultado"){
    if(!matrix) return;
    let html=`<h3>${label}</h3><div class="matrix-input matrix-result"><table>`;
    for(let i=0;i<matrix.length;i++){ html+='<tr>'; for(let j=0;j<matrix[i].length;j++){ html+=`<td>${Math.round(matrix[i][j]*10000)/10000}</td>`; } html+='</tr>'; }
    html+='</table></div>';
    const div=document.getElementById('result'); div.innerHTML=html;
    const cells=div.querySelectorAll('td');
    cells.forEach((cell,index)=>{ setTimeout(()=>{ cell.classList.add('show'); cell.style.backgroundColor=`hsl(${(index*30)%360},70%,80%)`; setTimeout(()=>{ cell.style.backgroundColor=''; cell.classList.add('highlight'); setTimeout(()=>cell.classList.remove('highlight'),500); },500); }, index*100); });
}

// TRANSFORMAR RESULTADO
function applyResultOption(){
    const option=document.getElementById('resultOption').value;
    if(!lastResult||lastResult.length===0) return;
    let transformed=lastResult;
    if(option==='transpose') transformed=transposeMatrix(lastResult);
    else if(option==='inverse'){ transformed=inverseMatrix(lastResult); if(!transformed) return; }
    else if(option==='determinant'){ if(lastResult.length!==lastResult[0].length){ showToast("Determinante solo para matrices cuadradas"); return; } transformed=[[determinant(lastResult)]]; }
    displayResult(transformed,"Resultado de las dos matrices ("+option+")");
}

// INICIALIZACIÓN
window.onload=generateMatrices;
</script>

</main>
</body>
</html>
